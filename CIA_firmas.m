% Definir las matrices del modelo
A = [0, 0, 0;
    0, 0, 0;
    0, 0, 0;
    -0.8177188, 0, 0;
    0, 0, 0];
B = [0, 1, -1;
    -1, 0, 0;
    0, 0, 0;
    0.6132891, 0, 0;
    .36, 0, 0];
C = [0, -1, -1, 0, 0;
    0, 0, 0, -1, 1;
    -1, -0.9688361, 1, 0, 0;
    -0.3863744, 0, 0, 0, 0.5908041;
    0, .64, 0, 0, -1];
D = [0, 0;
    0, 0;
    0, 0;
    0, 0;
    0, 1];
F = [0, 0, 0;
    0, 0, 0;
    0, 1, 0];
G = [0.36, 0, 0;
    0, 0, 0;
    0, -1, 0];
H = [0, 0, 0;
    0, 0, 0;
    0, 0, 0];
J = [0, -0.36, -1, 0, 0;
    -1, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
K = [0, 0, 0, 0, 0;
    1, 0, 0, 0.2575, 0;
    0, 0 ,0 ,0, 0];
L = [0, 1;
    0, 0;
    0, 0];
M = [0, 0;
    0, 0;
    -1, 0];
N = [.02, 0;
    0, .95];

[P, Q, R, S] = calculate_stable(A, B, C, D, F, G, H, J, K, L, M, N);


figure(1)
impulse_response(P,Q,R,S,N, 20, 1, [1; 4; 5; 6; 7; 8]);
legend('K','C', 'H', 'w', 'r', 'Y')
 
figure(2)
impulse_response(P,Q,R,S,N, 20, 1, 2:3);
legend('M', 'p')

figure(3)
impulse_response(P,Q,R,S,N, 50, 2, [1; 4; 5; 6; 7; 8]);
legend('K','C', 'H', 'w', 'r', 'Y')

figure(2)
impulse_response(P,Q,R,S,N, 50, 2, 2:3);
legend('M', 'p')

